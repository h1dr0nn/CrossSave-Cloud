PROJECT: CrossSave Cloud
FILE: coding_rules.txt
VERSION: 1.0

==================================================
GENERAL CODING GUIDELINES
==================================================

1. LANGUAGE STACK
- Frontend: Svelte + TypeScript
- Backend: Rust (Tauri backend)
- Platform targets: Linux (primary), Android (secondary)
- No backend server integrated yet unless specified

--------------------------------------------------

2. NAMING CONVENTIONS

2.1 Rust
- Modules: snake_case
- Files: snake_case.rs
- Structs & Enums: PascalCase
- Functions: snake_case
- Constants: SCREAMING_SNAKE_CASE
- Commands exposed to Tauri use #[tauri::command]

2.2 Frontend (Svelte + TS)
- Components: PascalCase.svelte
- Variables: camelCase
- Functions: camelCase
- Types/Interfaces: PascalCase
- Stores: camelCase + “Store” suffix (example: logsStore)

--------------------------------------------------

3. CODE ORGANIZATION

3.1 Rust
src-tauri/src/
    core/              → business logic (watcher, profiles, packager)
    api/               → tauri commands exposed to UI
    utils/             → helper functions
    main.rs            → Tauri entry

3.2 Svelte Frontend
src/
    lib/
        components/    → UI reusable components
        stores/        → global state stores
        helpers/       → utility functions
    routes/            → screens/pages

--------------------------------------------------

4. MODULE RESPONSIBILITY RULES

4.1 Watcher Module (Linux/Android)
- Only emits events
- No sync logic inside watcher
- No file packaging inside watcher

4.2 Sync Module
- Prepares metadata
- Compresses files
- Compares versions
- Performs upload/download calls

4.3 Emulator Profile Module
- Loads JSON configs
- Detects emulator paths
- Provides list of tracked folders

--------------------------------------------------

5. FUNCTION RULES

5.1 Rust
- Every function must return Result<T, E> unless trivial
- No unwrap() in production code
- Avoid blocking I/O in Tauri commands
- Heavy tasks must run in async thread via tauri::async_runtime

5.2 Svelte / TypeScript
- Avoid global variables, use stores
- Use async/await consistently
- Errors must be caught and logged to UI log panel
- No direct DOM manipulation (stick to Svelte reactivity)

--------------------------------------------------

6. LOGGING RULES

6.1 Rust Logs
- Use tracing crate
- Levels: trace / debug / info / warn / error
- Important events: file changes, sync start/end, errors

6.2 Frontend Logs
- Send logs to a UI log panel
- Use stores/logStore for log streaming
- Prefix logs: [WATCHER], [SYNC], [PROFILE], [UI]

--------------------------------------------------

7. FILE STRUCTURE RULES

7.1 Do not mix UI logic with backend Rust logic
7.2 Keep Rust modules small & focused
7.3 Profile definitions stored in:
    /resources/profiles/*.json
7.4 Avoid duplication – utilities go into utils/

--------------------------------------------------

8. GIT COMMIT RULES

8.1 Commit messages use English
8.2 Format:
    <category>: <description>
Examples:
    watcher: initial linux watcher
    profile: add retroarch default config
    sync: implement zip packaging
    ui: add sidebar layout
    infra: setup tauri config

8.3 No pushing generated files (e.g., build artifacts)

--------------------------------------------------

9. AGENT INSTRUCTION RULES
(For AI agents working on this repo)

9.1 Always follow coding_rules.txt before generating code
9.2 Always generate minimal, clean, readable code
9.3 Follow naming conventions strictly
9.4 Do not invent new architecture without request
9.5 Always integrate with existing structure
9.6 Prefer small PR-sized changes unless asked otherwise
9.7 Do not remove logs unless instructed
9.8 Do not change folder structure unless approved

--------------------------------------------------

10. SECURITY RULES

10.1 Never sync ROM/Bios files
10.2 Only handle save data (*.sav, *.srm, *.bin…)
10.3 Clear sensitive data before logging
10.4 No storing user credentials in plain text

==================================================
END OF FILE
==================================================
